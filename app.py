import streamlit as st
from collections import Counter

# -------------------- 1. Архетипы -------------------- #
ARCHETYPES: dict[int, dict[str, str]] = {
    1: {
        "название": "Путь Воина / Лидера",
        "описание": "Воплощение силы воли, инициативности, самостоятельности.",
        "свет": "Новатор, лидер, уверенный в себе.",
        "тень": "Упрямство, эгоизм, страх одиночества.",
        "задача": "Иди своим путём, не бойся быть первой и уникальной.",
        "рекомендации": "Смелее прояви лидерство: начни проект, который давно откладываешь."
    },
    2: {
        "название": "Путь Дипломата",
        "описание": "Чувствительность, гармония, партнёрство.",
        "свет": "Такт, эмпатия, умение выстраивать отношения.",
        "тень": "Созависимость, страх конфликтов.",
        "задача": "Учись выстраивать здоровые границы и честное взаимодействие.",
        "рекомендации": "Развивай навык открытого диалога без подавления своих чувств."
    },
    3: {
        "название": "Путь Творца",
        "описание": "Энергия радости, вдохновения, самовыражения.",
        "свет": "Артистизм, креатив, позитивность.",
        "тень": "Поверхностность, избегание глубины.",
        "задача": "Раскрывай таланты через творчество и игру.",
        "рекомендации": "Выбери творческое хобби и регулярно практикуй."
    },
    4: {
        "название": "Путь Строителя",
        "описание": "Стабильность, структура, надёжность.",
        "свет": "Практичность, терпение, порядок.",
        "тень": "Ригидность, страх перемен.",
        "задача": "Создавай прочный фундамент, упорядочивай пространство.",
        "рекомендации": "Составь пошаговый план долгосрочного проекта и следуй ему."
    },
    5: {
        "название": "Путь Искателя",
        "описание": "Свобода, перемены, жажда познания.",
        "свет": "Гибкость, общительность, любознательность.",
        "тень": "Импульсивность, избегание обязательств.",
        "задача": "Учись выстраивать внутренние опоры.",
        "рекомендации": "Запланируй путешествие или обучающий курс для расширения горизонтов."
    },
    6: {
        "название": "Путь Заботливого Сердца",
        "описание": "Ответственность, любовь, служение семье и обществу.",
        "свет": "Забота, преданность, душевность.",
        "тень": "Жертвенность, излишняя опека.",
        "задача": "Балансируй заботу о других и о себе.",
        "рекомендации": "Установи личные границы и практикуй само‑заботу ежедневно."
    },
    7: {
        "название": "Путь Мудреца",
        "описание": "Анализ, интуиция и глубина.",
        "свет": "Исследователь, наставник, философ.",
        "тень": "Замкнутость, изоляция.",
        "задача": "Делись знаниями, выходи из уединения.",
        "рекомендации": "Напиши пост, проведи мини‑лекцию или менторь новичка."
    },
    8: {
        "название": "Путь Управленца",
        "описание": "Сила, власть, материальный успех.",
        "свет": "Ответственность, организаторские способности.",
        "тень": "Жёсткость, стремление к контролю.",
        "задача": "Управляй с заботой, делегируй справедливо.",
        "рекомендации": "Проанализируй, где можно делегировать и снять излишний контроль."
    },
    9: {
        "название": "Путь Служителя",
        "описание": "Гуманизм, сострадание, завершение.",
        "свет": "Щедрость, зрелость, эмпатия.",
        "тень": "Выгорание, жертвенность.",
        "задача": "Уважай свои границы, не растворяйся в других.",
        "рекомендации": "Практикуй баланс отдачи и получения энергии."
    },
    11: {
        "название": "Путь Провидца",
        "описание": "Интуиция, духовные озарения, тонкое восприятие.",
        "свет": "Озарения, связь с Высшим.",
        "тень": "Расфокусировка, тревожность.",
        "задача": "Следуй внутреннему зову, заземляй идеи.",
        "рекомендации": "Веди дневник инсайтов, медитируй ежедневно."
    },
    22: {
        "название": "Архитектор нового мира",
        "описание": "Масштабное созидание, глобальные идеи.",
        "свет": "Мастер проектов, системный лидер.",
        "тень": "Страх провала, выгорание.",
        "задача": "Действуй пошагово, доверяй внутренней опоре.",
        "рекомендации": "Раздели большой проект на этапы и следуй плану."
    },
    33: {
        "название": "Учитель Учителей",
        "описание": "Безусловная любовь, духовное служение.",
        "свет": "Целительство, вдохновение.",
        "тень": "Спасательство, самопожертвование.",
        "задача": "Устанавливай здоровые границы, сохраняя энергию.",
        "рекомендации": "Выделяй время на восстановление и личные практики."
    },
}

# -------------------- 2. Вспомогательные функции -------------------- #

def reduce_num(n: int) -> int:
    """Сведём число к однозначному или мастер‑числу."""
    while n not in {11, 22, 33} and n > 9:
        n = sum(int(d) for d in str(n))
    return n


def calculate_matrix(day: int, month: int, year: int) -> dict[str, int]:
    """Возвращает словарь из 12 позиций матрицы"""
    d, m, y = day, month, year

    sum_d = sum(int(i) for i in str(d))
    sum_m = sum(int(i) for i in str(m))
    sum_y = sum(int(i) for i in str(y))

    soul_code = reduce_num(sum_d + sum_m + sum_y)      # код души
    karma_tail = reduce_num(sum_d + sum_m)              # карма
    life_path  = reduce_num(sum(int(i) for i in f"{d:02d}{m:02d}{y}"))  # путь души / жизненный путь
    gift       = reduce_num(sum_d + sum_y)              # дар
    body_code  = reduce_num(sum_m)                      # тело / реализация
    birth_code = reduce_num(sum_y)                      # энергия года

    gates      = reduce_num(abs(soul_code - karma_tail))
    abundance  = reduce_num(gift + body_code)
    memory     = reduce_num(birth_code + karma_tail)
    realization= reduce_num(life_path + gift)
    love       = reduce_num(karma_tail + body_code)
    spirit     = reduce_num(life_path + birth_code)

    return {
        "Число Жизненного Пути": life_path,
        "Число Души": soul_code,
        "Число Кармы": karma_tail,
        "Дар / Потенциал": gift,
        "Код Тела / Реализации": body_code,
        "Энергия года рождения": birth_code,
        "Врата Душ
